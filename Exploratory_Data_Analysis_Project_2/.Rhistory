qplot(votes, rating, data = movies) + stats_smooth("loess")qplot(votes, rating, data = movies, panel = panel.loess)
qplot(votes, rating, data = movies, panel = panel.loess)
qplot(votes, rating, data = movies, smooth = "loess")
qplot(votes, rating, data = movies, smooth = "loess") + geom_point()
qplot(votes, rating, data = movie)+ stats_smooth("loess") + geom_point()
qplot(votes, rating, data = movies)+ stats_smooth("loess") + geom_point()
qplot(votes, rating, data = movies)+geom_smooth() + geom_point()
swirl()
swirl()
library(swirl)
library(swirl)
swirl()
cx
cy
cmat
points(cx,cy, col=c('red','orange','purple',pch=3,cex=2,lwd=2))
points(cx,cy, col=c('red','orange','purple'),pch=3,cex=2,lwd=2))
points(cx,cy, col=c('red','orange','purple'),pch=3,cex=2,lwd=2)
mdist
mdist(x,y,cx,cy)
apply(distTmp, 2, which.min)
newClust
points(x,y)
points(x,y, pch=19)
points(x,y, pch=19)
points(x,y, pch=19, cex=2, col=col1[newClust])
points(x,y, pch=19, cex=2, col=cools1[newClust])
points(x,y, pch=19, cex=2, col=cols1[newClust])
points(x,y)
plot.new()
points(x,y)
points(x,y, pch=19, cex=2, col=cols1[newClust])
swirl()
cmat
points(cx,cy, col=c('red','orange','purple'),pch=3,cex=2,lwd=2)
mdist(x,y,cx,cy)
apply(distTmp,2,which.min)
points(x,y, pch=19, cex=2, col=cols1[newClust])
tapply(x, mean
)
?tappl
?tapply()
groups<-as.factor(rbinom(32,n=5,prob = 0.4))
groups
tapply(groups,groups,mean())
tapply(groups,groups,mean
)
tapply(groups,groups,length)
x
newClust
tapply(x, newClust,mean)
tapply(y, newClust,mean)
cols``
cols1
points(newCx, newCy, col=cols1,pch=8, cex=2, lwd=2)
mdis(x,y,newCx, newCy)
mdist(x,y, newCx, newCy)
apply(distTmp2,2, which.min)
points(x,y, pch=19, cex=2, col=cols1[newClust2])
tapply(x, newClust2, mean)
tapply(y, newClust2, mean)
points(finalCx, finalCy, col=cols1, pch=9, cex-2, lwd-2)
points(finalCx, finalCy, col=cols1, pch=9, cex=2, lwd=2)
kmeans(dataFrame,3)
kmObj
kmObj$iter
kmObj$cluster
plot(x,y, col=kmObj$cluster, pch=19, cex=2)
kmObj$centers
plot(kmObj$centers,colo=c('black','red','green'), pch=3, cex=2, lwd=3)
plot(kmObj$centers,col=c('black','red','green'), pch=3, cex=2, lwd=3)
points(kmObj$centers,col=c("black","red","green"),pch=3,cex=3,lwd=3)
plot(x,y, col=kmeans(dataFrame, 6)$cluster, pch=19, cex=2)
plot(x,y, col=kmeans(dataFrame, 6)$cluster, pch=19, cex=2)
plot(x,y, col=kmeans(dataFrame, 6)$cluster, pch=19, cex=2)
head(dataMatrix)
heatmap(dataMatrix)
myedit('addPatt.R')
rep(1)
rep(c(0,3))
rep(c(0,3), each=5)
source('addPatt.R', local = TRUE)
heatmap(dataMatrix)
mat
svd(mdt)
svd(mat)
matu%*%diag
diag %*% t(matv)
matu %*% diag %*% t(matv)
mat
scale(mat)
svd(scale(mat))
scale(mat)
prcomp(scale(mat))
svd
1
svd1
svd1$v
svd1$v[,1]
svd1$d
head(constantMatrix)
sdv2
sdv2svd2
svd2
svd2$d
svd2
svd2$v
svd2$v[,1:2]
svd2$d
dim(faceData)
a1 <- svd1$
u
a1 <- (svd1$u[,1] * svd1[1]) %*% t(svd1$u[,1] * svd1[1])
a1 <- (svd1$u[,1] * svd1$d[1]) %*% t(svd1$v[,1])
myImage(a1)
a2 <- svd1$u[,1:2] %*% svd1$d[1:2] %*% t(svd1$v[,1:2])
a2 <- svd1$u[,1:2] * svd1$d[1:2] %*% t(svd1$v[,1:2])
a2 <- svd1$u[,1:2]
a2 <- svd1$u[,1:2] %*% diag(svd1$d[1:2]) %*% t(svd1$v[,1:2])
a2
myImage(a2)
a2 <- svd1$u[,1:5] %*% diag(svd1$d[1:5]) %*% t(svd1$v[,1:5])
myImage(a2)
myImage(svd1$u[,1:5] %*% diag(svd1$d[1:5]) %*% t(svd1$v[,1:5]))
myImage(svd1$u[,1:10] %*% diag(svd1$d[1:10]) %*% t(svd1$v[,1:10]))
library(swirl)
swirl()
dim(ssd)
names(ssd)[:2]
names(ssd)[,:2]
names(ssd)
names(ssd)[-2]
names(ssd)[562:563]
names(ssd[562:563])
table(ssd$subject)
table(ssd$subject)
names(ssd[562:563])[1]
table(ssd$subject)
table(ssd$subject)[1]
sum(table(ssd$subject))
table(ssd$activity)
sub1 <- ssd[ssd$subject == 1]
ssd[ssd$subject == 1]
len(table(ssd$subject))
length(table(ssd$subject))
dim(table(ssd$subject))
ssd$subject == 1]
ssd$subject == 1
sum(ssd$subject == 1)
sub1 <1 subset(ssd, subject ==1 )
sub1 <- subset(ssd, subject ==1 )
dim(sub1)
names(sub1[1:12])
myedit('showXY.R')
showMe()
showMe(1:6)
mdist <- dist(sub1[,1:3])
hclustering<- hclust(mdist)
plot(hclustering, lab.col = unclass(sub1$activity))
myplclust(hclustering, lab.col = unclass(sub1$activity))
mdist <- dist(sub1[,10:12])
mdist
hcluster(mdist)
hclust(mdist)
hclustering <- hclust(mdist)
myplclust(hclustering, lab.col=unclass(sub1$activity))
svd1 <- svd(scale(sub1[,-c(562,563)]))
svd1$u
dim(svd1$u)
maxCon <- apply(svd1$v, which.min)
maxCon <- apply(svd1$v[,2], which.min)
maxCon <- apply(svd1$v[,2], which.min)
maxCon <- apply(svd1$v[,2], which.min())
maxCon <- apply(svd1$v,2, which.min)
maxCon <- apply(svd1$v,2, which.max)
maxCon <- which.max(svd1$v[,2])
mdist <- dist(sub1[,10:12, maxCon] )
mdist <- dist(sub1[,c(10:12, maxCon)] )
hclustering <- hclust(mdist)
myplclust(hclustering, lab.col = unclass(sub1$activity))
names(sub1[maxCon])
kClust <- kmeans(sub1[1:561],centers = 6)
kClust <- kmeans(sub1[,1:561],centers = 6)
kmeans(sub1[, -c(562, 563)], centers = 6)
kClust <-kmeans(sub1[, -c(562, 563)], centers = 6)
table(kClust$cluster, sub1$activity)
table(kClust$cluster, sub1$activity, nstart=100)
kClust <-kmeans(sub1[, -c(562, 563)], centers = 6, nstart = 100)
table(kClust$cluster, sub1$activity)
dim(kClust)
dim(kClust$centers)
laying <- which(kClust$size==29)
plot(kClust$centers[laying, 1:12], pch=19, ylab='Laying Cluster')
names(sub1[,1:3])
walkdown <- which(kClust$size==49)
plot(kClust$centers[walkdown, 1:12], pch=19. ylab="Walkdown Cluster")
plot(kClust$centers[walkdown, 1:12], pch=19, ylab="Walkdown Cluster")
setwd("/Volumes/Documents/Learning/Coursera_R_Assignments/Coursera_R_Assignments/Exploratory_Data_Analysis_Project_2")
getwd()
# PART ONE: download data from 'https://d396qusza40orc.cloudfront.net/exdata%2Fdata%2FNEI_data.zip' to ./data folder and unzip it into the same folder
# check if the download folder exists, if not, create it
if (!file.exists("./data")) {
dir.create("./data")
print("Creating ./data folder")
}
# then check if the zip file exists, if not, download it
if (!file.exists("./data/NEI_data.zip")) {
download.file("https://d396qusza40orc.cloudfront.net/exdata%2Fdata%2FNEI_data.zip",
destfile = "./data/NEI_data.zip")
print("Downloaded NEI_data.zip")
unzip("./data/NEI_data.zip", exdir = "./data")
print("Unzipped NEI_data.zip")
}
# STEP TWO: Read unziped data into R
NEI <- readRDS("./data/summarySCC_PM25.rds")
SCC <- readRDS("./data/Source_Classification_Code.rds")
# Question 1: Have total emissions from PM2.5 decreased in the United States
# from 1999 to 2008? Using the base plotting system, make a plot showing the
# total PM2.5 emission from all sources for each of the years 1999, 2002, 2005,
# and 2008.
library(ggplot2)
# Plot Emissions column from NEI data set, show emission by year
# First, aggregate emissions by year
NEI_by_year <- aggregate(Emissions ~ year, NEI, sum)
# Then, plot the data
plot(NEI_by_year$year, NEI_by_year$Emissions,
type = "l", xlab = "Year",
ylab = "Total PM2.5 Emissions",
main = "Total PM2.5 Emissions from All Sources by Year"
)
# Last, save the plot g to "Plot1.png" file in figure folder.
png("./figure/Plot1.png")
print("Png File has been created in the figure folder.")
# Question 1: Have total emissions from PM2.5 decreased in the United States
# from 1999 to 2008? Using the base plotting system, make a plot showing the
# total PM2.5 emission from all sources for each of the years 1999, 2002, 2005,
# and 2008.
library(ggplot2)
# Plot Emissions column from NEI data set, show emission by year
# First, aggregate emissions by year
NEI_by_year <- aggregate(Emissions ~ year, NEI, sum)
# Then, plot the data
plot(NEI_by_year$year, NEI_by_year$Emissions,
type = "l", xlab = "Year",
ylab = "Total PM2.5 Emissions",
main = "Total PM2.5 Emissions from All Sources by Year"
)
# Last, save the plot g to "Plot1.png" file in figure folder.
png(filename="./figure/Plot1.png")
print("Png File has been created in the figure folder.")
# Question 1: Have total emissions from PM2.5 decreased in the United States
# from 1999 to 2008? Using the base plotting system, make a plot showing the
# total PM2.5 emission from all sources for each of the years 1999, 2002, 2005,
# and 2008.
library(ggplot2)
# Plot Emissions column from NEI data set, show emission by year
# First, aggregate emissions by year
NEI_by_year <- aggregate(Emissions ~ year, NEI, sum)
# Then, plot the data
plot(NEI_by_year$year, NEI_by_year$Emissions,
type = "l", xlab = "Year",
ylab = "Total PM2.5 Emissions",
main = "Total PM2.5 Emissions from All Sources by Year"
)
# Last, save the plot g to "Plot1.png" file in figure folder.
png(filename="Plot1.png")
print("Png File has been created in the figure folder.")
# Question 1: Have total emissions from PM2.5 decreased in the United States
# from 1999 to 2008? Using the base plotting system, make a plot showing the
# total PM2.5 emission from all sources for each of the years 1999, 2002, 2005,
# and 2008.
png(filename="./figure/Plot1.png")
# First, aggregate emissions by year
NEI_by_year <- aggregate(Emissions ~ year, NEI, sum)
# Then, plot the data
plot(NEI_by_year$year, NEI_by_year$Emissions,
type = "l", xlab = "Year",
ylab = "Total PM2.5 Emissions",
main = "Total PM2.5 Emissions from All Sources by Year"
)
print("Png File has been created in the figure folder.")
dev.off()
# Question 2: Have total emissions from PM2.5 decreased in the Baltimore City,
# Maryland (fips == "24510")from 1999 to 2008? Use the base plotting system to
# make a plot answering this question.
library(ggplot2)
# Plot Emissions column from NEI data set, show emission by year
# First, aggregate emissions by year but filter fips == "24510"
NEI_by_year <- aggregate(Emissions ~ year, NEI[NEI$fips == "24510", ], sum)
# change the ggplot theme
theme_set(theme_light())
# Then, plot the data
g <- ggplot(NEI_by_year, aes(x = year, y = Emissions)) +
geom_line() +
labs(
title = "Total PM2.5 Emissions by Year in Baltimore City, Maryland",
x = "Year",
y = "Total PM2.5 Emissions"
)
# Last, save the plot to "plot2.png" file in figure folder.
ggsave("./figure/plot2.png", plot = g, width = 5, height = 5, units = "in")
print('Png File has been created in the figure folder.')
# Question 2: Have total emissions from PM2.5 decreased in the Baltimore City,
# Maryland (fips == "24510")from 1999 to 2008? Use the base plotting system to
# make a plot answering this question.
library(ggplot2)
# Plot Emissions column from NEI data set, show emission by year
# First, aggregate emissions by year but filter fips == "24510"
NEI_by_year <- aggregate(Emissions ~ year, NEI[NEI$fips == "24510", ], sum)
# change the ggplot theme
theme_set(theme_light())
# Then, plot the data
g <- ggplot(NEI_by_year, aes(x = year, y = Emissions)) +
geom_line() +
labs(
title = "Total PM2.5 Emissions by Year in Baltimore City, Maryland",
x = "Year",
y = "Total PM2.5 Emissions"
)
# Last, save the plot to "plot2.png" file in figure folder.
ggsave("./figure/Plot2.png", plot = g, width = 5, height = 5, units = "in")
print('Png File has been created in the figure folder.')
# Question 2: Have total emissions from PM2.5 decreased in the Baltimore City,
# Maryland (fips == "24510")from 1999 to 2008? Use the base plotting system to
# make a plot answering this question.
library(ggplot2)
# Plot Emissions column from NEI data set, show emission by year
# First, aggregate emissions by year but filter fips == "24510"
NEI_by_year <- aggregate(Emissions ~ year, NEI[NEI$fips == "24510", ], sum)
# change the ggplot theme
theme_set(theme_light())
# Then, plot the data
g <- ggplot(NEI_by_year, aes(x = year, y = Emissions)) +
geom_line() +
labs(
title = "Total PM2.5 Emissions by Year in Baltimore City, Maryland",
x = "Year",
y = "Total PM2.5 Emissions"
)
# Last, save the plot to "plot2.png" file in figure folder.
ggsave("./figure/Plot2.png", plot = g, width = 8, height = 5, units = "in")
print('Png File has been created in the figure folder.')
# Question3: Of the four types of sources indicated by the type (point, nonpoint,
# onroad, nonroad) variable, which of these four sources have seen decreases in
# emissions from 1999–2008 for Baltimore City? Which have seen increases in
# emissions from 1999–2008? Use the ggplot2 plotting system to make a plot
# answer this question.
library(ggplot2)
# Plot Emissions column from NEI data set, show emission by year
# First, filter NEI dataset which filter fips == "24510"
NEI_Baltimore <- NEI[NEI$fips == "24510", ]
# Then map SCC data set to NEI_Baltimore data set
NEI_Baltimore <- merge(NEI_Baltimore, SCC, by = "SCC", all.x = TRUE)
# Then, group by year and Data.Category, and sum Emissions column
NEI_Baltimore <- aggregate(Emissions ~ year + Data.Category, NEI_Baltimore, sum)
# change the ggplot theme
theme_set(theme_light())
# Then, plot the data and show each Data.Category column in different line color
g <- ggplot(NEI_Baltimore, aes(x = year, y = Emissions)) +
geom_line(aes(color = Data.Category)) +
labs(
title = "Total PM2.5 Emissions by Type in Baltimore City, Maryland",
x = "Year",
y = "Total PM2.5 Emissions"
)
# Last, save the plot to "plot3.png" file in figure folder.
ggsave("./figure/Plot3.png", plot = g, width = 8, height = 5, units = "in")
print("Png File has been created in the figure folder.")
# Question3: Of the four types of sources indicated by the type (point, nonpoint,
# onroad, nonroad) variable, which of these four sources have seen decreases in
# emissions from 1999–2008 for Baltimore City? Which have seen increases in
# emissions from 1999–2008? Use the ggplot2 plotting system to make a plot
# answer this question.
library(ggplot2)
# Plot Emissions column from NEI data set, show emission by year
# First, filter NEI dataset which filter fips == "24510"
NEI_Baltimore <- NEI[NEI$fips == "24510", ]
# Then map SCC data set to NEI_Baltimore data set
NEI_Baltimore <- merge(NEI_Baltimore, SCC, by = "SCC", all.x = TRUE)
# Then, group by year and Data.Category, and sum Emissions column
NEI_Baltimore <- aggregate(Emissions ~ year + Data.Category, NEI_Baltimore, sum)
# change the ggplot theme
theme_set(theme_light())
# Then, plot the data and show each Data.Category column in different line color
g <- ggplot(NEI_Baltimore, aes(x = year, y = Emissions)) +
geom_line(aes(color = Data.Category)) +
scale_color_discrete(name = "Type") +
labs(
title = "Total PM2.5 Emissions by Type in Baltimore City, Maryland",
x = "Year",
y = "Total PM2.5 Emissions"
)
# Last, save the plot to "plot3.png" file in figure folder.
ggsave("./figure/Plot3.png", plot = g, width = 8, height = 5, units = "in")
print("Png File has been created in the figure folder.")
# Question4: Across the United States, how have emissions from coal combustion-related sources changed from 1999–2008?
library(ggplot2)
# First, map SCC data set to NEI data set
NEI_merged <- merge(NEI, SCC, by = "SCC", all.x = TRUE)
# Then, filter NEI_merged data set EI.Sector contains coal
NEI_coal <- NEI_merged[grep("coal", NEI_merged$EI.Sector, ignore.case = TRUE), ]
# Then, group NEI_coal data set by year and sum Emissions column
NEI_coal <- aggregate(Emissions ~ year, NEI_coal, sum)
# change the ggplot theme
theme_set(theme_light())
# Then, plot NEI_coal by year
g <- ggplot(NEI_coal, aes(x = year, y = Emissions)) +
geom_line() +
labs(
title = "Total PM2.5 Emissions from Coal Combustion-related
Sources by Year in the United States",
x = "Year",
y = "Total PM2.5 Emissions"
)
# Last, save the plot to "plot4.png" file in figure folder.
ggsave("./figure/plot4.png", plot = g, width = 12, height = 5, units = "in")
print("Png File has been created in the figure folder.")
# Question4: Across the United States, how have emissions from coal combustion-related sources changed from 1999–2008?
library(ggplot2)
# First, map SCC data set to NEI data set
NEI_merged <- merge(NEI, SCC, by = "SCC", all.x = TRUE)
# Then, filter NEI_merged data set EI.Sector contains coal
NEI_coal <- NEI_merged[grep("coal", NEI_merged$EI.Sector, ignore.case = TRUE), ]
# Then, group NEI_coal data set by year and sum Emissions column
NEI_coal <- aggregate(Emissions ~ year, NEI_coal, sum)
# change the ggplot theme
theme_set(theme_light())
# Then, plot NEI_coal by year
g <- ggplot(NEI_coal, aes(x = year, y = Emissions)) +
geom_line() +
labs(
title = "Total PM2.5 Emissions from Coal Combustion-related
Sources by Year in the United States",
x = "Year",
y = "Total PM2.5 Emissions"
)
# Last, save the plot to "plot4.png" file in figure folder.
ggsave("./figure/Plot4.png", plot = g, width = 12, height = 5, units = "in")
print("Png File has been created in the figure folder.")
# Question5: How have emissions from motor vehicle sources changed from 1999–2008 in Baltimore City?
library(ggplot2)
# First, Filter NEI by fips == "24510"
NEI_Baltimore <- NEI[NEI$fips == "24510", ]
# Then, mapp NEI_Baltimore data set to SCC data set
NEI_Baltimore <- merge(NEI_Baltimore, SCC, by = "SCC", all.x = TRUE)
# Then, filter NEI_merged data set EI.Sector contains vehicles
NEI_vehicle <- NEI_merged[grep("vehicles", NEI_merged$EI.Sector, ignore.case = TRUE), ]
# Then, group NEI_Baltimore data set by year and sum Emissions column
NEI_vehicle <- aggregate(Emissions ~ year, NEI_vehicle, sum)
# change the ggplot theme
theme_set(theme_light())
# Then, plot NEI_vehicle by year
g <- ggplot(NEI_vehicle, aes(x = year, y = Emissions)) +
geom_line() +
labs(
title = "Total PM2.5 Emissions from Motor Vehicle Sources by Year in Baltimore City",
x = "Year",
y = "Total PM2.5 Emissions"
)
# Last, save the plot to "plot5.png" file in figure folder.
ggsave("./figure/Plot5.png", plot = g, width = 8, height = 5, units = "in")
print("Png File has been created in the figure folder.")
# Question6: Compare emissions from motor vehicle sources in Baltimore City
# with emissions from motor vehicle sources in Los Angeles County, California
# (fips == "06037"). Which city has seen greater changes over time in motor
# vehicle emissions?
library(ggplot2)
#-------------------------Working on Baltimore City-----------------------------
# First, Filter NEI by fips == "24510"
NEI_Baltimore <- NEI[NEI$fips == "24510", ]
# Then, map NEI_Baltimore data set to SCC data set
NEI_Baltimore <- merge(NEI_Baltimore, SCC, by = "SCC", all.x = TRUE)
# Then, filter NEI_Baltimore data set EI.Sector contains vehicles
NEI_Baltimore_Vehicle <- NEI_Baltimore[grep("vehicles", NEI_Baltimore$EI.Sector,
ignore.case = TRUE
), ]
# Then, group NEI_Baltimore data set by year and sum Emissions column
NEI_Baltimore_Vehicle <- aggregate(Emissions ~ year, NEI_Baltimore_Vehicle, sum)
#-----------------Working on Los Angeles County, California---------------------
# First, Filter NEI by fips == "06037"
NEI_LA <- NEI[NEI$fips == "06037", ]
# Then, map NEI_LA data set to SCC data set
NEI_LA <- merge(NEI_LA, SCC, by = "SCC", all.x = TRUE)
# Then, filter NEI_LA data set EI.Sector contains vehicles
NEI_LA_Vehicle <- NEI_LA[grep("vehicles", NEI_LA$EI.Sector,
ignore.case = TRUE
), ]
# Then, group NEI_LA data set by year and sum Emissions column
NEI_LA_Vehicle <- aggregate(Emissions ~ year, NEI_LA_Vehicle, sum)
# change the ggplot theme
theme_set(theme_light())
# Plot both NEI_LA_Vehicle and NEI_Baltimore_Vehicle by year in different line colors
g <- ggplot() +
geom_line(data = NEI_LA_Vehicle, aes(x = year, y = Emissions, color = "red")) +
geom_line(data = NEI_Baltimore_Vehicle, aes(
x = year, y = Emissions,
color = "blue"
)) +
labs(
title = "Total PM2.5 Emissions from Motor Vehicle Sources by
Year in Baltimore City and Los Angeles County, California",
x = "Year",
y = "Total PM2.5 Emissions"
) +
scale_color_manual(
name = "City",
values = c("red" = "red", "blue" = "blue"),
labels = c("Los Angeles County, California", "Baltimore City")
)
# Last, save the plot to "plot6.png" file in figure folder.
ggsave("./figure/Plot6.png", plot = g, width = 8, height = 5, units = "in")
print("Png File has been created in the figure folder.")
